# 2. 루프 논리를 단순화하기



## 7.읽기 쉽게 흐름제어 만들기



핵심 아이디어 : 흐름을 제어하는 조건과 루프 그리고 여타 요솔르 최대한 '자연스럽게' 만들도록 노력하라. 코드를 읽다가 다시 되돌아가서 코드를 읽지 않아도 되게끔게끔 만들어야 한다.

### 조건문에서 인수의 순서



| 왼쪽                               | 오른쪽                                        |
| ---------------------------------- | --------------------------------------------- |
| 값이 더 유동적인 '질문을 받는'표현 | 더 고정적인 값으로,비교대상으로 사용되는 표현 |



### if/else 블록의 순서



- 부정이 아닌 긍정을 다루어라. 즉 if(debug)를 선호하자
- 간단한 것을 먼저 처리하라. 이렇게 하면 동시에 같은 화면에 if와 else 구문을 나타낼 수도 있다.
- 더 흥미롭고. 확실한 것을 먼저 다루어라.



때때로 이러한 규칙이 서로 충돌을 일으켜서 판단을 내려야 할 때야 할 때 있다.



### (삼항 연산자로 알려진)? :를 이요하는 조건문 표현



**핵심 아이디어**

줄 수를 최소화하는 일보다 다른 사람이 코드를 읽고 이해하는 데 걸리는 시간을 최소화하는 일이 더 중요하다.

기본적으로 if/else 를 이용하라. ?: 를 이용하는 삼항 연산은 매우 간단할 때만 사용해야 한다.



### do/while 루프를 피하라



내 경험으로 에러와 혼등의 원인은 do문에 있따. 그래서 나는 조건이 '눈에 뜨이는 곳에 미리'나타나도록 만드는 것을 선호한다. 결과적으로 do문을 피하는 경향이 있다.



### 함수 중간에서 반환하기

| 언어         | 클린업 코드를 위한 관용적 구조 |
| :----------- | :----------------------------- |
| C++          | destructors                    |
| 자바, 파이썬 | try finnally                   |
| 파이썬       | with                           |
| C#           | using                          |

반환포인트를 하나만 두려는 건 함수의 끝 부분에서 실행되는 클린업 코드의 호출을 보장하려는 의도다.



### 중첩을 최소화하기

중첩이 심할수로 코드를 읽는 사람이 스택에 추가적인 스택이 입력되어 이해하기 어렵다.

수정해야 하는 상황이라면 여러분의 코드를 새로운 관점에서 바라보라.

함수 중간에서 반환하여 중첩을 제거하라.



###  실행의 흐름을 따라올 수 있는가?



| 프로그래밍 구조         | 상위수준의 프로그램 흐름이 혼란스러워지는 방식               |
| ----------------------- | ------------------------------------------------------------ |
| 스레딩                  | 어느 코드가 언제 실행되는지 불분명하다.                      |
| 시그널/ 인터럽트 핸들러 | 어떤 코드가 어떤 시점에 실행될지 모른다                      |
| 예외                    | 예외처리가 여러 함수 호출을 거치면서 실행될 수 있다          |
| 함수 포인터 & 익명 함수 | 실행할 함수가 런타임에 결정되기 때문에 컴파일 과정에서는 어떤 코드가 실행될지 알기 어렵다. |
| 가상 메소드             | object.virtualMetohd()는 알려지지 않은 하위 클래스 코들르 호출할지도 모른다 |

핵심은 코드를 작성할때 이러한 구조가 차지하는 비율이 너무 높지 않아야 한다.



### 요약

비교구문 : 변환 값 (왼쪽), 안정값 (오른쪽)

if/les 긍정적이고 쉽고 눈에 띄는 경우가 앞으로  간다.

삼항연산자나 do/while goto같은 구조는 종종 가독성을 떨어뜨려 구조를 대신할수 있는 방법이 존재함므로 되도록 사용하지 않는다.

지나친 중첩을 피하려면 '선형적인 '코드를 추구하라.

함수 중간에 반환하면 중첩을 피하고 깔끔한 코드가 된다. 함수 앞에 보호구문으로 간단한 경우를 미리처리하는 방식도 유용하다.





## 8. 거대한 표현을 잘게 쪼개기



**핵심 아이디어**: 거대한 표현을 더 소화하기 쉬운 여러 조각으로 나눈다.



### 설명 변수

커다란 표현을 쪼개는 가장 쉬운 방법은 하위표현을 담을 추가 변수를 만드는 것이다.



### 요약 변수

커다란 코드의 덩어리를 짧은 이름으로 대체하여 더쉽게 관리하고 파악하는 목적을 가진 변수를 요약변수라고 한다.



### 드모르간의 법칙 사용하기



```
1) not (a or b or c ) <=> (not a) and (not b) and (not c)
2) not (a and b and c )<=> (not a) or (not b) or (not c)
```

이런 표현식을 

```fi
if(!(file_exists && !is_protectred)) Error();
```

이런 식으로 수정할 수 있다.



### 쇼트 서킷 논리 오용 말기



코드를 작성할 때 짧은 코드로 작성하는 즐거움에 빠져 나중에 코드를 읽는 사람으로 하여금 정신적인 장애물이 될수 있다.

**'영리하게'작성된 코드에 유의하라. 나중에 다른 사람이 읽으면 코드가 종종 혼란을 초래한다.**

적절한 예

```
if (obejct && object -> method())...
-> x = a || b || c
```



### 예: 복잡한 논리와 씨름하기

해결책을 찾는법

생각한 방식의 반대되는 방법으로 해결할 수 있는지 확인해 보는 것

배열같은것을 역순이나 데이터 구조를 뒤로 가면서 채워 넣는것 같은 의미



- 범위가 겹치는 코드의 예를 생각하는 법

1.다른 범위가  범위 시작보다 전에 끝난다.

2.다른 범위가 이 범위가 끝난 후에 시작된다.



### 요약

설명변수를 도입하는 것은 커다란 코드를 읽기 쉽게 쪼갤수 있다.

장점

- 거대한 표현을 작은 조각으로 나눈다
- 하위표현을 간결한 이름으로 대체하여 코드를 문서화한다.
- 코드를 읽는 사람이 코드의 핵심 '개념'을 파악하는 것을 돕는다.



다른 테크닉은 드모르간 법칙을 사용한다. ex) !(a && !b) -> (!a || b)

가끔은 문제의 의미를 거꾸로 부정 하거나 의도한 목적의 반대편을 생각해 볼 필요도 있다.

커다란 코드의 블록을 쪼개는 데에도 적용 될수 있따. 논리를 만나면 쪼개서 나누는 일을 두려워하지 마라.

