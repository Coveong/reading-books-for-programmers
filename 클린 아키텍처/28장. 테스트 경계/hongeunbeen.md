# 28장. 테스트 경계

테스트는 시스템의 일부이며, 아키텍처에도 관여합니다.

# 시스템 컴포넌트인 테스트

**테스트는 아키텍처 관점에서에서는 모두 동일합니다.**

작은 테스트이든 대규모 테스트이든, 이들 테스트는 아키텍처적으로 모두 동등합니다.

**테스트는 아키텍처에서 가장 바깥쪽 원입니다.** 

테스트는 태생적으로 의존성 규칙을 따르는데 테스트는 세부적이며 구체적인 것으로, 의존성은 항상 테스트 대상이 되는 코드를 향합니다.

시스템 내부의 어떤 것도 테스트에는 의존하지 않으며, 테스트는 시스테므이 컴포넌트를 향해, 항상 원의 안쪽으로 의존합니다.

**테스트는 독립적으로 배포가능합니다.**

**테스트는 시스템 컴포넌트 중에서 가장 고립되어 있습니다.**

테스트의 역할은 운영이 아니라 개발을 지원하는데 있습니다.

하지만 많은 면에서 테스트는 다른 모든 시스템 컴포넌트가 반드시 지켜야 하는 모델을 표현해 줍니다.

# 테스트를 고려한 설계

개발자는 테스트가 시스템의 설계 범위 밖에 있다고 여길 수 있지만 테스트가 시스템의 설계와 잘 통합되지 않으면, 테스트는 깨지기 쉬워지고, 시스템은 뻣뻣해져서 변경하기가 어려워집니다.

문제는 바로 결합에 잇습니다.

시스템 컴포넌트와 결합된 테스트라면 깨지기 쉬운 테스트 문제가 발생합니다.

이 문제를 해결하기 위해서는 테스트를 고려해서 설계해야 합니다.

소프트웨어 설계의 첫 번째 규칙은 항상 변동성이 있는 것에 의존하지 말아야 한다는 것입니다.

# 테스트 API

테스트가 모든 업무 규칙을 검증하는 데 사용할 수 있도록 특화된 API로 작성합니다.

1. 보안 제약사항을 무시할 수 있습니다.
2. (DB와 같은) 값 비싼 자원을 건너 뛸 수 있습니다.
3. 시스템을 테스트 가능한 특정 상태로 강제하는 강력한 힘을 지닙니다.

API는 사용자 인터페이스가 사용하는 인터ㅐㄱ터와 인터페이스 어댑터들의 위 집합이 될 것입니다.

즉, 테스트API는 테스트 구조를 애플리케이션 구조로부터 결합을 분리할 목적으로 사용합니다.

# 구조적 결합

구조적 결합은 테스트 결합 중에서 가장 강합니다.

만약, 상용 클래스나 메서드 중 하나라고 변경되면 딸려 있는 다수의 테스트가 변경되어야 한다면 테스트는 깨지기 쉬워지고, 이로 인해 상용 코드를 뻣뻣하게 만듭니다.

테스트API 역할은 애프리케이션의 구조를 테스트로부터 숨기는데 있습니다.

→ 따로따로 진화할 수 있다는 점은 필수적입니다.

# 보안

테스트 API는 강력한 힘을 가지고 있어 운영 시스템에 배포 시 위험에 처할 수 있습니다.

위험을 피하기 위해 스트 API 자체와 그 중 위험한 부분의 구현부는 독립적으로 배포할 수 있는 컴포넌트로 분리해야 합니다.

# 결론

📌  테스트는 시스템 외부에 있지 않고 시스템의 일부입니다.

📌  테스트에서 기대하는 안정성과 회귀의 이점을 얻을 수 있으려면 테스트는 잘 설계되어야 합니다.
