# 테스트 경계

테스트는 시스템의 일부이며 아키텍처에도 관여한다.

## 시스템 컴포넌트인 테스트

테스트는:
* 태생적으로 의존성 규칙을 따른다.
  * 세부적이며 구체적인 것이므로 아키텍처의 가장 바깥족 원으로 생각할 수 있다.
* 독립적으로 배포 가능하다.
* 시스템 컴포넌트 중에서 가장 고립되어 있다.
  * 하지만 테스트가 시스템 컴포넌트가 아니라는 뜻은 아니다. 

## 테스트를 고려한 설계

테스트가 시스템의 설계와 잘 통합되지 않으면, 테스트는 깨지기 쉬워지고, 시스템은 뻣뻣해져서 변경하기가 어려워진다.

시스템이 강하게 결합된 테스트라면 사소한 변경이 수많은 테스트를 망가뜨릴 수 있다.

> 변동성이 있는 것에 의존하지 말라.

## 테스트 API

이 목표를 달성하려면 테스트가 모든 업무 규칙을 검증하는 데 사용할 수 있도록 특화된 API를 만들면 된다.

* 보안 제약사항을 무시할 수 있는 강력한 힘을 지녀야 한다.
* 사용자 인터페이스가 사용하는 인터렉터와 인터페이스 어댑터들의 상위 집합이다.
* 테스트 구조를 애플리케이션 구조로부터 결합을 분리하는 게 목표다.

### 구조적 결합

테스트 API의 역할은 애플리케이션의 구조를 테스트로부터 숨기는 데 있다.

이렇게 만들면 상용 코드를 리팩터링하거나 진화시키더라도 테스트에는 전혀 영향을 주지 않는다. (반대 상황에도 동일)

### 보안

테스트 API가 지닌 강력한 힘을 운영 시스템에 배포하면 위험할 수 있기 떄문에 위험한 부분의 구현부는 독립적으로 배포할 수 있는 컴포넌트로 분리해야 한다.

# 결론

테스트는 시스템 외부에 있지 않고 시스템의 일부로 간주해야 한다. 그렇지 않으면 깨지기 쉽고 유지보수하기 어려워진다.
