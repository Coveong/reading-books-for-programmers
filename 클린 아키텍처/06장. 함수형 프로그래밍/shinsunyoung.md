# 06장. 함수형 프로그래밍

핵심은 람다!

함수형 언어에서 변수는 변경되지 않는다.

# 불변성과 아키텍처

- 경합(race) 조건
- 교착상태(deadlock) 조건
- 동시 업데이트(concurrent update) 문제

모두 가변 변수로 인해 발생한다.

= 불변 변수를 사용하면 이런 문제가 발생하지 않는다.

= 동시성 어플리케이션에서 마주치는 모든 문제, 즉 다수의 스레드와 프로세스를 사용하는 어플리케이션에서 마주치는 모든 문제는 가변 변수가 없다면 발생하지 않는다.

불변성이 정말 실현 가능한가

- ㅇㅇ
- 하지만 타협이 필요하다.

# 타협 - 가변성의 분리

불변 컴포넌트와 가변 컴포넌트를 분리한다.

- 불변 컴포넌트
    - 순수하게 함수형으로 작업
    - 가변 변수 사용 X
    - 함수형 컴포넌트가 아닌 다른 컴포넌트와 통신 가능

        ![image](https://user-images.githubusercontent.com/42836576/119271831-3b129580-bc3e-11eb-8adc-93bcf60f5aab.png)

- 가변 컴포넌트
    
    - 가변 변수 사용 가능

⇒ 애플리케이션을 제대로 구조화하려면 **변수를 변경하는 컴포넌트와 변경하지 않는 컴포넌트를 분리**해야 한다는 것이다.

현명한 아키텍트라면 가능한 많은 처리를 불변 컴포넌트에서 하고, 가변 컴포넌트에서는 코드를 줄여야 한다.

# 타협 - 이벤트 소싱

- 상태가 아닌 트랜잭션을 저장
    - ex. 계좌 잔고 조회할 때마다 개설 시점부터 발생한 모든 트랜잭션을 더한다.
    - 가변 변수 필요 X
    - 엥 그게 가능? 너무 용량이 많이 들지 않나?
        - 영원히 동작하도록 만들 필요 없음. 애플리케이션의 수명주기동안만 문제 없이 동작할 정도의 저장 공간, 처리 능력만 있으면 충분함
- CRUD가 아니라 CR만 수행하는 것임
    - 동시 업데이트 문제가 일어나지 않음

# 결론

- 구조적 프로그래밍은 제어흐름의 직접적인 전환에 부과되는 규율이다.
- 객체 지향 프로그래밍은 제어흐름의 간접적인 전환에 부과되는 규율이다.
- 함수형 프로그래밍은 변수 할당에 부과되는 규율이다.

**소프트웨어, 즉 컴퓨터 프로그램은 순차(sequence), 분기(selection), 반복(iteration), 참조(indirection)로 구성된다.** 그 이상도 이하도 아니다.