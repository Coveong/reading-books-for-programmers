# 크고 작은 모든 서비스들

서비스 지향 아키텍처와 마이크로서비스 아키텍처가 최근에 큰 인기를 끄는 이유

* 서비스를 사용하면 상호 결합이 철저하게 분리되는 것처럼 보인다.
  * 나중에 보겠지만, 이는 일부만 맞는 말이다. 
* 서비스를 사용하면 개발과 배포 독립성을 지원하는 것처럼 보인다.
  * 나중에 보겠지만, 이 역시도 일부만 맞는 말이다. 

## 서비스 아키텍처

먼저 서비스를 사용한다는 것은 본질적으로 아키텍처에 해당하지 않는다.

단순히 애플리케이션의 행위를 분리할 뿐인 서비스는 의존성 규칙을 준수하며 고수준의 정책을 저수준의 세부사항으로부터 분리하는 경계에 의해 정의되는 아키텍처와는 다른 양상을 띄고 있다.

서비스는 프로세스나 플랫폼 경계를 가로지르는 함수 호출에 지나지 않는다.

## 서비스의 이점?

각각의 이점에 대한 저자의 이의 제기를 살펴보자.

### 결합 분리의 오류

시스템을 서비스들로 분리함으로써 서비스 사이의 결합이 잘 분리된다고 착각할 수 있다.

하지만 프로세서 내의 또는 네트워크 상의 공유 자원, 특히 서로 공유되는 데이터들 때문에 결합될 가능성이 여전히 존재한다.

예를 들어 서비스 사이를 오가는 데이터 레코드에 새로운 필드를 추가한다면 이 필드를 사용해 동작하는 모든 서비스는 반드시 변경되어야 한다.

### 개발 및 배포 독립성의 오류 

전담팀이 데이터를 소유하고 운영하기 떄문에 개발 및 배포 독립성이 확장 가능하다고 간주할 수 있다.
대규모 엔터프라이즈 시스템을 독립적으로 개발하고 배포 가능한 몇백개의 서비스들을 이용하여 만들 수 있다고 믿는다.

하지만 확장 가능한 시스템을 구축하기 위해 모노리틱 시스템이나 컴포넌트 기반 시스템 등 다양한 선택지를 선택할 수 있다.

또 '결합 분리의 오류'에 따르면 서비스라고 해서 항상 독립적으로 개발하고, 배포하며, 운영할 수 있는 것은 아니다.

## 야옹이 문제

한 택시 통합 시스템을 상상해보자. 새로운 '야옹이 배달' 서비스를 제공하기 위해 기능을 추가하려고 한다.
![image](https://user-images.githubusercontent.com/32327475/123559031-a539cf80-d7d4-11eb-85e1-c64142ac9e69.png)

이 경우 **모든** 서비스를 횡단해서 수정해야 한다. 서비스들이 모두 결합되어 있어서 독립적으로 개발하고 배포하거나 유지될 수 없기 때문이다.(횡단 관심사가 가지는 문제)

### 객체가 구출하다

![image](https://user-images.githubusercontent.com/32327475/123558997-71f74080-d7d4-11eb-8520-b790a1071838.png)

다형적으로 확장할 수 있는 클래스 집합을 생성해 새로운 기능을 처리하도록 할 수 있다.

물론 서비스에서도 이렇게 구현할 수 있다.

## 횡단 관심사

지금까지 배운 것은 아키텍처 경계가 서비스 사이에 있지 않고 서비스를 관통하며 서비스를 컴포넌트 단위로 분할한다는 것이다.

모든 주요 시스템이 직면하는 횡단 관심사를 처리하려면 서비스 내부는 의존성 규칙도 준수하는 컴포넌트 아키텍처로 설계해야 한다.

아키텍처 경계를 정의하는 것은 이 서비스들이 아니다. 서비스 내에 위치한 컴포넌트다.

# 결론

서비스는 시스템 확장성과 개발 가능성 측면에서 유용하지만 그 자체로는 아키텍처적으로 그리 중요한 요소가 하이다.

시스템의 아키텍처는 시스템 내부에 그어진 경계와 경계를 넘나드는 의존성에 의해 정의된다.
