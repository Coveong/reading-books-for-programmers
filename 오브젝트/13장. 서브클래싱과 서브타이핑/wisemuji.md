# 서브클래싱과 서브타이핑

상속의 일차적인 목표는 코드 재사용이 아니라 타입 계층을 구현하는 것이여야 한다.

그렇다면 타입 계층을 구성하는 원칙은 무엇이 있을까?

## 타입

### 개념 관점의 타입

타입의 구성 요소:
* 심볼: 타입에 이름을 붙인 것
* 내연: 타입에 속하는 객체들이 가지는 공통적인 속성이나 행동
* 외연: 타입에 속하는 객체들의 집합

### 프로그래밍 언어 관점의 타입

* 타입에 수행될 수 있는 오퍼레이션의 집합 정의
* 타입에 수행되는 오퍼레이션에 대해 미리 약속된 문맥 제공

### 객체지향 패러다임 관점의 타입

* 객체의 퍼블릭 인터페이스가 객체의 타입을 결정한다. 따라서 동일한 퍼블릭 인터페이스를 제공하는 객체들은 동일한 타입으로 분류된다.

객체를 바라볼 떈 항상 객체가 외부에 제공하는 행동에 초점을 맞춰야 한다.

## 타입 계층

### 타입 사이의 포함관계

슈퍼타입은 다음과 같은 특징을 가지는 타입을 가리킨다.
* 집합이 다른 집합의 모든 멤버를 포함한다.
* 타입 정의가 다른 타입보다 좀 더 일반적이다.

서브타입은 다음과 같은 특징을 가지는 타입을 가리킨다.
* 집합에 포함되는 인스턴스들이 더 큰 집합에 포함된다.
* 타입 정의가 다른 타입보다 좀 더 구체적이다.

### 객체지향 프로그래밍과 타입 계층

* 슈퍼타입이란 서브타입이 정의한 퍼블릭 인터페이스를 일반화시켜 상대적으로 범용적이고 넓은 의미로 정의한 것이다.
* 서브타입이란 슈퍼타입이 정의한 퍼블릭 인터페이스를 특수화시켜 상대적으로 구체적이고 좁은 의미로 정의한 것이다.

**서브타입의 인스턴스는 슈퍼타입의 인스턴스로 간주될 수 있다.**

## 서브클래싱과 서브타이핑

### 언제 상속을 사용해야 하는가?

(by 마틴 파울러) 다음 둘은 만족할 때
1. 상속 관계가 is-a 관계를 모델링할때
2. 클라이언트 입장에서 부모 클래스의 타입으로 자식 클래스를 사용해도 무방할 때 (행동 호환성)

인터페이스 분리 원칙: 인터페이스를 클라이언트의 기대에 따라 분리함으로써 변경에 의해 영향을 제어하는 설계 원칙

### 서브클래싱과 서브타이핑이란?

나누는 기준은 상속을 사용하는 목적

서브클래싱: 다른 클래스의 코드를 재사용할 목적으로 상속을 사용하는 경우 - 구현(클래스) 상속
서브타이핑: 타입 계층을 구성하기 위해 상속을 사용하는 경우 - 인터페이스 상속

## 리스코프 치환 원칙

> 정의: 서브타입은 그것의 기반 타입에 대해 대체 가능해야 한다. 즉 클라이언트가 차이점을 인식하지 못한 채 기반 클래스의 인터페이스를 통해 서브클래스를 사용할 수 있어야 한다.

클라이언트 관점에서 행동이 호환되는지 여부를 확인하기

(예를 들어 Square가 Rectangle을 대체할 수 없는 이유는 클라이언트 관점에서 Square와 Rectangle이 다르기 때문임)

### 클라이언트와 대체 가능성

자식 클래스가 부모 클래스를 대체하기 위해서는 부모 클래스에 대한 클라이언트의 가정을 준수해야 한다.

-> 클라이언트와 격리한 채로 본 모델은 의미있게 검증하는 것이 불가능하다

즉, 대체 가능성을 결정하는 것은 클라이언트

### is-a 관계 다시 살펴보기

상속이 서브타이핑을 위해 사용될 경우에만 is-a관계이다. 서브클래싱을 구현하기 위해 상속을 사용했다면 is-a관계가 아니다.

### 리스코프 치환 원칙은 유연한 설계의 기반이다

클라이언트 입장에서 퍼블릭 인터페이스의 행동 방식이 변경되지 않는다면 클라이언트의 코드를 변경하지 않고도 새로운 자식 클래스와 협력할 수 있게 되어 유연하고 확장성있는 설계가 가능해진다.

## 계약에 의한 설계와 서브타이핑

* 계약에 의한 설계: 클라이언트와 서버 사이의 협력을 의무와 이익으로 구성된 계약의 관점에서 표현하는 것
  * 클라이언트가 정상적으로 메서드를 실행하기 위해 만족시켜야 하는 사전조건
  * 메서드가 실행된 후에 서버가 클라이언트에게 보장해야 하는 사후조건
  * 메서드 실행 전과 실행 후에 인스턴스가 만족시켜야하는 클래스 불변식
  * 이 세 가지로 구성됨

서브타입이 리스코프 치환 원칙을 만족시키기 위해서는 클라이언트와 슈퍼타입 간에 체결된 계약을 준수해야 한다.











