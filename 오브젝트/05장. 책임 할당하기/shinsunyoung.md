# 05장. 책임 할당하기

# 책임 주도 설계를 향해

- 데이터보다 행동을 먼저 결정하라
- 협력이라는 문맥 안에서 책임을 결정하라

## 데이터보다 행동을 먼저 결정하라

객체의 행동, 즉 책임을 먼저 결정한 후에 객체의 상태를 결정해야한다.

## 협력이라는 문맥 안에서 책임을 결정하라

책임은 객체의 입장이 아니라 객체가 참여하는 협력에 적합해야 한다.

→ 메시지가 객체를 선택하게 해야 한다.

## 책임 주도 설계

3장에서 설명한 내용이다.

- 시스템이 사용자에게 제공해야 하는 기능인 시스템 책임을 파악한다.
- 시스템 책임을 더 작은 책임으로 분할한다.
- 분할된 책임을 수행할 수 있는 적절한 객체 또는 역할을 찾아 책임을 할당한다.
- 객체가 책임을 수행하는 도중 다른 객체의 도움이 필요한 경우 이를 책임질 적절한 객체 또는 역할을 찾는다.
- 해당 객체 또는 역할에게 책임을 할당함으로써 두 객체가 협력하게 한다.

# 책임 할당을 위한 GRASP 패턴

GRASP → 일반적인 책임 할당을 위한 소프트웨어 패턴

## 도메인 개념에서 출발하기

- 설계를 시작하기 전에 도메인에 대한 개략적인 모습을 그려 보는 것이 유용하다.
    - 단, 너무 많은 시간을 들이지 말고 빠르게 설계와 구현을 진행하라

## 정보 전문가에게 책임을 할당하라

책임을 수행할 정보를 알고 있는 객체에게 책임을 할당하는 패턴 → 정보 전문가(information expert) 패턴

단, 객체가 정보를 '저장'할 필요는 없다. 정보를 제공할 다른 객체를 알고 있거나 필요한 정보를 계산해서 제공할 수도 있다.

## 높은 응집도와 낮은 결합도

두 협력 패턴 중에서 높은 응집도와 낮은 결합도를 얻을 수 있는 설계가 있다면 그것을 선택해야한다.

→ 낮은 결합도(low coupling) 패턴, 높은 응집도(high cohesion) 패턴

## 창조자에게 객체 생성 책임을 할당하라

어떤 방식으로든 생성되는 객체와 연결되거나 관련될 필요가 있는 객체에 해당 객체를 생성할 책임을 맡기는 것

→ 창조자(creator) 패턴

# 구현을 통한 검증

## 클래스 응집도 판단하기

- 클래스가 하나 이상의 이유로 변경되어야 한다면 응집도가 낮은 것이다. 변경의 이유를 기준으로 클래스를 분리하라
- 클래스의 인스턴스를 초기화하는 시점에 경우에 따라 서로 다른 속성들을 초기화하고 있다면 응집도가 낮은 것이다. 초기화되는 속성의 그룹을 기준으로 클래스를 분리하라.
- 메서드 그룹이 속성 그룸을 사용하는지 여부로 나뉜다면 응집도가 낮은 것이다. 이들 그룹을 기준으로 클래스를 분리하라.

## 다형성

객체의 타입에 따라 변하는 행동이 있다면 타입을 분리하고 변화하는 행동을 각 타입의 책임으로 할당하는 것

→ 다형성(polymorphism) 패턴

## 변경 보호

변경을 캡슐화하도록 책임을 할당하는 것

→ 변경 보호(protected variations) 패턴

## 변경과 유연성

변경에 수용할 수 있도록 코드를 유연하게 만드는 것이 중요하다.

상속보다는 합성을 사용하자

# 책임 주도 설계의 대안

## 메서드 응집도

긴 메서드는?

- 어떤 일을 수행하는지 한 눈에 파악하기 어렵기 때문에 코드 이해에 오랜 시간이 걸린다.
- 변경이 필요할 때 수정해야할 부분을 찾기 어렵다.
- 일부 로직만 수정하더라도 나머지 부분에서 버그가 발생할 수 있다.
- 로직의 일부만 재사용하는 것이 불가능하다.
- 코드 중복을 초래하기 쉽다.

→ 몬스터 메서드라고도 불린다.

메서드를 응집도 있는 수준으로 분해해야 한다.

## 객체를 자율적으로 만들자

자신이 소유하고 있는 데이터는 자기 스스로 처리하도록 만드는 것이 자율적인 객체를 만든