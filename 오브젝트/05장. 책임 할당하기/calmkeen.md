# 05. 책임 할당하기



## 01.책임 주도 설계를 향해



원칙

- 데이터보다 행동을 먼저 결정하라
- 협력이라는 문맥 안에서 책임을 결정하라



#### 데이터보다 행동을 먼저 결정하라

- 객체지향 설계에서 가장 중요한 것은 적절한 객체에게 적절한 책임을 할당하는 것
  - 어떤 객체에게 어떤 책임을 할당하는 가를 항상 생각하자

#### 협력이라는 문맥 안에서 책임을 결정하라

- 협력에 적합한 책임을 수확하기 위해서는 객체를 결정한 후에 메시지를 선택하는 것이 아니라 메세지를 결정한 후에 객체를 선택해야 한다.
- 메시지가 클라이언트의 의도를 표현한다.



#### 책임 주도 설계

3장에 설명을 되집어 보자

- 시스템이 사용자에게 제공해야 하는 기능인 시스템 책임을 파악한다.
- 시스템 책임을 더 작은 책임으로 분할
- 분할된 책임을 수행할 수 있는 적절한 객체 또는 역할을 찾아 책임을 할당한다.



## 02. 책임 할당을 위한 GRASP패턴



"General Responsibilty Assignment Software Pattern"[일반적인 책임 할당을 위한 소프트웨어 패턴]

- 책일 할당시 지침으로 삼을수 있는 원칙들의 집합 패턴 형식



#### 도메인 개념에서 출발하기

도메인 개념을 정리하는 데 너무 많은 시간을 들이지 말고 빠르게 설계와 구현을 진행하라.

>  올바른 도메인은 존재하지 않는다. 필요한 것은 도메인 그대로 투여한 모델이 아니라 구현에 도움이 되는 모델이다.



#### 정보 전문가에게 책임을 할당하라

책임 주도 설계 방식의 첫 단계는 애플리케이션이 제공해야 하는 기능을 애필리케이션의 책임으로 생각하는 것이다.

이에 책임할 메세지를 정하고  메세지를 수신할 객체가 아니라 전송할 객체의 의도를 반영해서 결정해야 한다.

1. 메세지를 전송할 객체는 무엇을 원하는가?

2. 메세지를 수신할 적합한 객체는 누구인가?



> INFORMATION EXPERT(정보 전문가) 패턴
>
> 책임을 수행하는데 필요한 정보를 가지고 있는 객체에게 할당하라.
>
> 정보와 행동을 최대한 가까운 곳에 위치시켜 캡슐화를 유지한다.

3.  절차와 구현을 고민해 본다.
4. 메세지를 책임질 객체를 선택한다.



#### 높은 응집도와 낮은 결합도

> LOW COUPING 패턴
>
> 의존성을 낮추고 변화의 영향을 줄이며 재사용성을 증가시킬수 있을까 에서 나온 패턴



> HIGH COHESION 패턴
>
> > 어떻게 복잡성을 관리할 수 있는 수준으로 유지할 것인가에서 나온 패턴
> >
> > 현재 책임 할당을 검토하고 있거나 여러 설계 대안 중 하나를 선택해야 한다면 높은 응집도를 유지할수 있는 설계를 선택



####  창조자에게 객체 생성 책임을 할당하라



> CREATOR 패턴
>
> > 어떤 방식으로든 생성되는 객체와 연결되거나 관련될 필요가 있는 객체에 해당 객체를 생서할 책임을 맡기는 것



## 03. 구현을 통한 검증



하나이상의 클래스에는 위험 징후를 또렷하게  나타내는 패턴이 존재한다.

1. 인스턴스 변수가 초기화 되는 시점
   - 해결방법 : 함꼐 초괴화 되는 속성을 기준으로 코드를 분리해야 한다.
2. 메서드들이 인스턴스 변수를 사용하는 방식
   - 해결방법 : 속성 그룹과 해당 그룹에 접근하는 메서드 그룹을 기준으로 코드를 분리
3.  하나 이상의 변경이유를 가져 응집도가 낮다.
   - 해결방법 : 변경의 이유에 따라 클래스를 분리

#### 다형성을 통해 분리하기

역할을 사용해 객체의 구체적인 타입을 추상화 해라.

역할을 대체할 클래스들 사이에서 구현을 공유해야 할 필요가 있다면 추상 클래스를 사용하면 된다.

역할을 대체하는 객체드르이 책임만 정의하고 싶다면 인터페이스를 사용하면 된다.



**다형성(POLYMORPHISM)**이란

- 객체의 타입에 따라 변하는 행동이 있다면 타입을 분리하고 변화하는 행동을 각 타입의 책임으로 할당



#### 변경으로부터 보호하기

**변경 보호(PROTECTED VARIATIONS)**란

- 변경을 캡슐화 하도록 책임을 할당하는 것



**구현을 가이드 할 수 있는 도메인 모델을 선택해라**

**도메인의 구조가 코드의 구조를 이끌어내는 것은 자연스러울 뿐 아니라 바람직한 것이다.**



#### 변경과 유연성

개발자로서 변경에 대비할 수 있는 것

1. 코드를 이해하고 수정하기 쉽도록 최대한 단순하게 설계
2. 코드를 수정하지 않고도 변경을 수용할 수 있도록 코드를 유연하게 설계



도메인 모델은 코드에 대한 가이드를 제공하며 코드의 변화에 맞게 함꼐 변화해야 한다.

도메인 모델을 코드와 분리된 막연한 무엇으로 생각하지 말자.



## 04. 책임 주도 설계의 대안



**리팩터링(Refactoring)**

- 이해하기 쉽고 수정하기 쉬운 소프트웨어로 개선하기 위해 겉으로 보이는 동작은 바꾸지 않은 책 내부 구조를 번경하는 것



#### 메서드 응집도



긴 메서드는 여러 측면에서 **부정적** 이다.why?

1. 업무수행을 한눈에 판단할수 없다.
2. 하나의 메서드안에서 너무 많은 작업을 처리해 수정할 부분을 찾기 어렵다
3. 일부 로직만 수정하더라도 나머지 부분에서 버그 발생 확률이 높다.
4. 일부로직만 재사용하는 것이 불가능 하다.
5. 재사용의 유일한 방법은 코드 ctrl+ c /v









