# 5.구부러지거나 부러지거나



유연함을 유지하는 한가지 좋은 방법은 가능한 적은 양의 코드를 작성하는 것이다.



## 결합도 죽이기와 디미터 법칙

코드를 모듈로 구성하고 이들 간의 상호작용을 제한하라.



### 결합도 줄이기

의존의 증가가 나쁜점 : 시스템 어딘가의 무관한 변화가 코드에 영향을 미칠 수 있는 위험이 커지기 때문이다.



징후

1. 단위 테스트를 링크하기 위한 명령어가 테스트 프로그램 자쳅다 긴 대규모 c, c++ 프로젝트
2. 한 모듈의 '간단한' 수정이 이와 관계없는 모듈을 통해 시스템 전역에 퍼져나가는 경우
3. 개발자가 수정한 부분이 시스템에 어떤 영향을 미칠지 몰라 코드의 수정을 두려워 하는 경우



불필요한 의존이 많은 시스템은 요지보수가 어렵고, 비용이 많이 들며 불안정하다.



### 디미터 함수 법칙

프로그램에서 모듈간 결합도를 최소화 하려 하는 것

> 모듈간의 결합도를 치소화하라



### 확실히 차이를 낳는가?

응답집합이 큰 클래스는 작은 크래스보다 에러를 발생시키기가 쉽다.

디미터 법칙 역시 만들려는 애플리케이션에 맞게 장점과 단점을 잘 고려해야 한다.



## 27. 메타 프로그래밍



### 동적 설정

시스템을 되도로고 설정가능하게 만들어라.

> 통합하지 말고 설정하라



메타데이터를 이용하여 반환 매개 변수, 사용자 선호사항, 설치 디렉터리같은 애플리케이션 설정 옵션을 기술하라.

- 메타데이터란? 
  - 데이터에 과한 데이터이다. 스키마 데이터 디렉터리등이 대표적이다.



### 메타데이터 주도 애플리케이션



가능한 많은 메타데이터를 써서 애플리케이션을 설정하고 실행시켜라.

> 코드에는 추상화를, 메타데이터에서는 세부사항을.



이점 

- 설계의 결합도를 줄여 좀 더 유연하고 적응성있는 프로그램을 만들 수 있다.
- 세부사항을 코드 밖으로 몰아냄으로써 보다 강하고 추상적인 디자인을 만들 수 있다.
- 애플리케이션을 컷그터마이징하기 위해 다시 컴파일할 필요가 없다.
- 메타데이터는 범용 프로그래밍 언어보다 문제 도메인에 가까운 방식으로 표현될 수 있다.
- 동일한 애플리케이션 엔진과 상이한 메타데이터를 이용해 여러 다른 프로젝트를 진행할 수 있게 된다.



#### 비지니스 로직

환경을 동적으로 설정할 수 있는 크나큰 유연함을 제공해 준다.

분산 시스템을 사용해 설정 가능하고 동적인 시스템으로 구성할수 있게 된다.



### 도도 코드를 작성하지 마라

적응이나 유연성을 얻지 못한 코드나 경력을 가지지 말자.( 적응하지 못해 빠르게 멸종한 종이라는 뜻으로 도도를 쓰심)



## 28. 시간적 결합

동시성을 허용해 시간이나 순서에 따른 의존성의 결합을 끊는 방법을 생각할 필요가 있다.

그렇게 함으로써 유연성, 작업흐름 분석, 아키텍처, 설계, 배치와 같은 개발 여러 측면에서 시간과 관련된 모든 의존성을 줄일 수 있다.



### 작업흐름



UML : 다이어그램 같은  표기법을 사용해서 기술해 준 흐름을 기록하는 방법

활동  다이어그램을 사용하면 동시에 수행될 수 있지만 아직 그렇지 않은 활동들을 찾아내서 병렬성을 극대화 할 수 있다.

> 작업흐름 분석을 통해 동시성을 개선하라



### 아키텍쳐

설켸 과정에서 제약조건

- 데이터베이스 작업은 완료하는데 상대적으로 긴 시간이 걸린다.
- 각 트랜잭션마다, 데이터베이스 트랜잭션이 처리되는 동안에도 통신 서비스를 중단해서는 안된다.
- 동시에 진행되는 세션이 너무 많으면 데이터베이스 성능이 저하된다.
- 데이터 선마다 다수의 트랙잭션들이 동시적으로 진행중이다.



배고픈 소비자 모델: 빠르고 간단하게 부하를 분산할 수 있는 방법

> 서비스를 사용해서 설계해라



사실 우리는 컴포넌트 대신 서비스를 , 즉 잘 정의되고 일관성 있는 인터페이스 뒤에서 일하는 독립적이고 동시적인 객체들을 만든 것이다.



### 동시성을 고려한 설계

모든 전역변수나 정적 변수들을 동시 접근으로부터 보호해야 한다.

호출될 가능성이 있는 모든 시간에 언제나 객체가 유효한 상태에 있도록 만들어야 한다.



#### 더 깔끔한 인터페이스

동시성과 시간순서에 따른 의존성을 고려하는 것은 더 깔끔한 인터페이스로 설계된다.

> 언제나 동시성을 고려해 설계하라.



## 29. 단지 뷰일 뿐이야



모듈이후에  런타임 객체 논리적 의존성등을 생각할때

 이벤트라는 개념에 대해 시작한다.

이벤트는 객체들 사이의 결합을 최소화 할 수 있다.



### 출판 / 구독

이벤트를 루틴 하나에 몰아넣는 일이 나쁜 이유?

 객체 캡슐화에 위배!

결합도 증가

![image-20210808173855960](C:\Users\user.DESKTOP-MH5KDIR.000\AppData\Roaming\Typora\typora-user-images\image-20210808173855960.png)

시퀸스 다이어그램은 객체들을 세로줄로 나열해 놓고, 그 객체들 사이의 메시지 흐름을 보이는 다이어그램이다.

메시지는 전송자 줄에서 수신자 줄로 향한 화살표에 이름이 붙은 형태로 그린다.이름 옆에 붙은 * 것은 여러개가 전송될수 있따는 뜻이다.



### 모델 - 뷰 - 컨트롤러

MVC로 모델을 표시하는 뷰 뷰를 관리하는 컨트롤러에서 모델을 분리해내는 것



> 모델에서 뷰를 분리하라.



### GUI를 넘어서

- 모델

   : 대상 객체를 나타내는 추상 데이터 모델. 모델은 어떤 뷰나 컨트롤러에 대해서도 직접적인 지식을 지니지 않는다.

- 뷰
  : 모델을 해석하는 방법. 뷰는 모델의 변화 컨트롤러가 보내는 논리적 사건을 구독

- 컨트롤러
  : 뷰를 제어하고 모델에 새로운 데이터를 제공하는 방법



## 30. 칠판

칠판시스템 : 칠판에  의문을 적어놓고 자신의 생각과 아는 분야의 지식을 말하며 연결고리를 찾는것

> 칠판을 사용해 작업흐름을 조율하라

javaspace, tspace등 칠판 시스템을 사용해서 객체의 흐름에 기반한 알고리즘 설계등의 일에 사용해보아라.

참여자는 요소들의 독립성과 고립성을 유지하는 동시에 이질적인 행위자들을 잘 조정하는데 사용할 수 있다.