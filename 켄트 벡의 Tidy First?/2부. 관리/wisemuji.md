# 관리
> 코드 정리의 적용 대상을 파악하고 적용한다고 해서 코드 정리를 마스터한 것은 아닙니다. 이 책의 제목은 물음표가 강조된 제목입니다.
> 코드 정리법을 적용할 수 있다고 해서 반드시 코드를 정리해야 한다는 뜻은 아니라는 점을 강조하고 싶었습니다.

## Chapter 16 코드 정리 구분
코드 정리는 별도의 PR로 만들고 가급적 PR당 몇 개의 코드 정리만 넣는다.

(리뷰어들이 주저하지 않도록) 변경 사항을 나누어 별도의 PR로 만들고 코드 정리와 동작 변경 사이를 번갈아 가면서 전환할 때마다 새 PR을 연다.

**장단점 비교**:
- 크고 포괄적인 PR로 만들면 전체 그림을 보여주지만, 검토하는 입장에서는 유용한 피드백을 제공하기에는 너무 큰 덩어리다.
- 작은 여러 개의 PR은 소소한 피드백을 유도할 수 있지만, 잡초처럼 무시될 수 있다.

<img src="https://github.com/Coveong/reading-books-for-programmers/assets/32327475/5e808473-2f38-4108-a9ad-874eb988b401" width="30%" />


## Chapter 17 연쇄적인 정리
작은 단계로 나누어 코드를 정리하는 방식을 고수하되, 각 단계를 최적화하면서 실험해보자. 
너무 많이, 너무 빠르게 변경하지 않도록 주의한다.
> 코드 정리는 자꾸 손이 가는 감자칩과 같습니다. 한 개를 먹으면 바로 또 먹고 싶어집니다. 따라서 코드를 계속 정리하고 싶은 충동을 관리하는 것도 코드 정리의 핵심 기술입니다.

- 보호 구문
- 안 쓰는 코드 제거
- 대칭으로 맞추기(코드 정리 패턴 일원화)
- 새로운 인터페이스로 기존 루틴 부르기
- 읽는 순서 정리
- 응집도를 높이는 배치
- 설명하는 변수
- 설명하는 상수
- 명시적인 매개변수
- 비슷한 코드끼리
- 도우미 추출
- 하나의 더미
- 설명하는 주석
- 불필요한 주석 지우기(절대적으로 완전히 중목된 주석만 삭제하라, 즉 주석을 오직 모두 필요한 내용으로만 정리)

## Chapter 18 코드 정리의 일괄 처리량
많은 조직에서 하나의 변경 사항을 검토하고 배포하는 데 드는 고정 비용은 상당히 많다. 코드 정리 비용을 줄이고자 한다면 코드 정리 개수를 늘려서 동작 변경에 소요되는 비용을 줄이자.

**일괄 처리 규모를 줄이면 검토 비용이 줄고 코드 정리 비용도 줄어든다.**

> 여러분과 여러분의 팀은 검토 비용을 제대로 줄일 수 있는 방법을 찾아야 합니다.
> 팀에 신뢰와 강력한 문화가 있다면 코드 정리 후에는 굳이 검토할 필요가 없습니다.
> 검토하지 않더라도 코드 정리가 소프트웨어 안정을 해치지 않으면 상호작용의 위험이 줄어듭니다.

## Chapter 19 리듬
동작 변경은 코드 안에 뭉쳐서 나타나는 경향이 있다.

> 한 번의 코드 정리에 한 시간 이상이 걸린다면, 이는 원하는 동작 변경을 위해 필요한 최소한의 구조 변경 시기를 놓쳤다는 의미일 수 있습니다.

## Chapter 20 얽힘 풀기
코드의 동작 변경과 코드 정리가 얽히게 되었다면 다음 세 가지 선택지 중 세 번째 선택지를 권장한다.
1. 그대로 배포한다. - 검토하는 사람들이 무례하다 느끼고, 오류가 발생하기 쉽다.
2. 코드 정리와 변경 사항을 별도의 하나 이상의 PR로 나누거나 하나의 PR을 여러 번의 커밋으로 나눈다. - 무례함은 줄일 수 있지만 작업 횟수는 늘어난다.
3. 진행중인 작업을 버리고, 코드 정리를 선행하는 순서로 다시 시작한다. - 작업은 더 많아지지만 이어지는 커밋과의 일관성은 분명해진다.

> 우리가 작성하는 코드는 컴퓨터에 지시할 뿐 아니라 컴퓨터에 지시하려는 여러분의 의도를 사람들에게도 설명해야 하기 때문이죠.
> 컴퓨터에 지시만 하는 빠른 수행이 흥미로운 최종 목표가 되는 것은 아닙니다.

## Chapter 21 코드 정리 시점

**다음 상황에는 코드 정리를 하지 말자.**
- 앞으로 다시는 코드를 변경하지 않을 때
- 설계를 개선하더라도 배울 것이 없을 때

**다음 상황에서는 나중으로 정리를 미루자.**
- 정리할 코드 분량이 많은데, 보상이 바로 보이지 않을 때
- 코드 정리에 대한 보상이 잠재적일 때
- 작은 묶음으로 여러 번에 나눠서 코드 정리를 할 수 있을 때

**다음 상황에서는 동작 변경 후에 정리하자.**
- 다음 코드 정리까지 기다릴수록 비용이 더 불어날 때
- 코드 정리를 하지 않으면 일을 끝냈다는 느낌이 들지 않을 때

**다음 상황에서는 코드 정리 후에 동작 변경을 하자.**
- 코드 정리를 했을 때 코드 이해가 쉬워지거나 동작 변경이 쉬워지는 즉각적인 효과를 얻을 수 있을 때
- 어떤 코드를 어떻게 정리해야 하는지 알고 있을 때
