# 9장 단위테스트

# TOC

- [Contents](#contents)
  * [TDD 법칙 세 가지](#tdd-법칙-세-가지)
  * [깨끗한 테스트 코드 유지하기](#깨끗한-테스트-코드-유지하기)
    + [테스트 코드가 깨끗하지 않으면?](#테스트-코드가-깨끗하지-않으면?)
    + [테스트는 유연성, 유지 보수성, 재사용성을 제공한다.](#테스트는-유연성,-유지-보수성,-재사용성을-제공한다)
    + [깨끗한 테스트 코드](#깨끗한-테스트-코드)
    + [도메인에 특화된 테스트 언어](#도메인에-특화된-테스트-언어)
    + [이중 표준](#이중-표준)
    + [테스트 당 assert 하나](#테스트-당-assert-하나)
    + [테스트 당 개념 하나](#테스트-당-개념-하나)
  * [F.I.R.S.T](#first)
- [Reference](#reference)

<br>

# Contents

## TDD 법칙 세 가지

1. 실패하는 단위 테스트를 작성할 때까지 실제 코드를 작성하지 않는다.
2. 컴파일은 실패하지 않으면서 실행이 실패하는 정도로만 단위테스트를 작성한다,
3. 현재 실패하는 테스트를 통과할 정도로만 실제 코드를 작성한다.

<br>

## 깨끗한 테스트 코드 유지하기

### 테스트 코드가 깨끗하지 않으면?

1. 새 버전을 출시할 때마다 팀이 테스트 케이스를 유지하고 보수하는 비용이 늘어난다.
2. 어웅 테스트 코드 짜기 너무 힘들고 도움도 안 되는 것 같아
3. 테스트 슈트 폐기!
4. 결함률이 높아진다.
5. 변경을 주저하게 되고, 코드는 망가지고, 테스트 코드에 대한 실망감만 남는다.

⇒ 테스트 코드는 설계 코드 못지않게 중요하다.

<br>

### 테스트는 유연성, 유지 보수성, 재사용성을 제공한다.

그렇기 때문에 테스트 코드를 깨끗하게 유지해야 한다.

<br>

### 깨끗한 테스트 코드

**가독성**이 가장 중요하다. (실제 코드보다 더)

그러기 위해 명료성, 단순성, 풍부한 표현력이 필요하다.

- BUILD-OPERATE-CHECK
    1. 테스트 자료를 만든다.
    2. 테스트 자료를 조작한다.
    3. 조작한 결과가 올바른지 확인한다.
- 진짜 필요한 자료 유형과 함수만 사용한다.

<br>

### 도메인에 특화된 테스트 언어

API 위에 함수와 유틸리티를 구현하고 그걸 사용

<br>

### 이중 표준

실제 코드와 다르게 효율성보다 가독성에 비중을 두어라

테스트 환경에서는 자원이 제한적일 가능성이 낮기 때문이다.

<br>

### 테스트 당 assert 하나

assert문이 하나인 함수는 결론이 하나다.

하지만 asser를 하나만 사용한다면 코드의 중복이 생길 수도 있다.

이를 해결하기 위해서 아래 방법을 사용한다.

- TEMPLATE METHOD 패턴 사용
    - given/when 부분을 부모 클래스에 두고
    - then 부분을 자식 클래스에 두는 방식

→ 공통부분을 별도의 method로 끄집어내는데 들어가는 노력이 더 클 수 있다.

필요한 경우에는 assert를 여러 개를 두되 assert 문 개수는 최대한 줄이려고 노력하는 것이 가장 좋다.

<br>

### 테스트 당 개념 하나

1. 개념 당 assert문 수를 최소로 줄여라
2. 테스트 함수 하나는 개념 하나만 테스트하라

<br>

## F.I.R.S.T

- **F**ast : 테스트는 빨리 돌아가야 한다.
- **I**ndependent : 테스트는 서로 의존하면 안 된다. 한 테스트가 다음 테스트의 실행을 준비해서도 안 된다.
- **R**epeatable : 테스트는 어떤 환경에서도 반복 가능해야 한다. (네트워크가 없어도 돌아가야한다.)
- **S**elf-Validating : 결과값은 boolean이여야한다. (성공/실패)
- **T**imely : 실제 코드 구현 전에 작성해야 한다.

<br><br>

# Reference

[Clean Code](https://book.naver.com/bookdb/book_detail.nhn?bid=7390287)

[클린코드 9장 - 단위테스트](http://amazingguni.github.io/blog/2016/06/Clean-code-11-%EC%8B%9C%EC%8A%A4%ED%85%9C)