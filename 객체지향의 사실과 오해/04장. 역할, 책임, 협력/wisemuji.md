# 역할, 책임, 협력

이 장에서는 객체지향 설계의 품질을 결정하는 역할, 책임, 협력의 개념에 관해 살펴본다. 그리고 협력이 어떤 식으로 객체의 외양과 특성을 결정하는지를 설명한다.

## 협력

다수의 요쳥과 응답으로 구성되며 전체적으로 다수의 연쇄적인 요청과 응답의 흐름으로 구성된다.

어떤 객체가 특정한 요청을 받아들일 수 있는 이유는 그 요청에 대해 적절한 방식으로 응답하는 데 필요한 지식과 행동 방식을 가지고 있기 때문이다. 
그리고 요청과 응답은 협력에 참여하는 객체가 수행할 책임을 정의한다.

## 책임

어떤 대상에 대한 요청은 그 대상이 요청을 처리할 책임이 있음을 암시한다.

### 책임의 분류

* 하는 것(doing)
  * 객체를 생성하거나 계산을 하는 등의 스스로 하는 것
  * 다른 객체의 행동을 시작시키는 것
  * 다른 객체의 활동을 제어하고 조절하는 것
* 아는 것(knowing)
  * 개인적인 정보에 관해 아는 것
  * 관련된 객체에 관해 아는 것
  * 자신이 유도하거나 계산할 수 있는 것에 관해 아는 것
  
책임은 외부에 제공해줄 수 있는 정보(아는 것)와 서비스(하는 것)의 목록이다. 따라서 책임은 객체의 공용 인터페이스를 구성한다.

### 책임과 메시지

한 객체가 다른 객체에게 주어진 책임을 수행하도록 요청을 보내는 것을 메시지 전송이라고 한다.

## 역할

역할은 협력 내에서 다른 객체로 대체할 수 있음을 나타내는 일종의 표식이다.

역할의 개념을 사용하면 유사한 협력을 추상화해서 인지 과부하를 줄일 수 있다. 또 다양한 객체들이 동일한 협력에 참여할 수 있기 때문에 협력이 좀 더 유연해지며 재사용성이 높아진다. 

역할은 객체지향 설계의 단순성(simplicity), 유연성(flexibility), 재사용성(reusability)을 뒷받침하는 핵심 개념이다.

## 객체의 모양을 결정하는 협력

### 흔한 오류
1. 시스템에 필요한 데이터를 저장하기 위해 객체가 존재한다.
1. 객체지향이 클래스와 클래스 간의 관계를 표현하는 시스템의 정적인 측면에 중점을 둔다.

바로잡기: 객체가 존재하는 이유는 행위를 수행하며 협력에 참여하기 위해서고 그게 객체지향의 핵심이다.

## 객체지향 설계 기법

### 책임-주도 설계(RDD)

객체의 역할, 책임, 협력을 고안하기 위한 방법과 절차를 제시한다.

* 시스템이 사용자에게 제공해야 하는 기능인 시스템 책임을 파악한다.
* 시스템 책임을 더 작은 책임으로 분할한다.
* 분할된 책임을 수행할 수 있는 적절한 객체 또는 역할을 찾아 책임을 할당한다.
* 객체가 책임을 수행하는 중에 다른 객체의 도움이 필요한 경우 이를 책임질 적절한 객체 또는 역할을 찾는다.
* 해당 객체 또는 역할에게 책임을 할당함으로써 두 객체가 협력하게 된다.

### 디자인 패턴

책임-주도 설계의 결과를 표현한다. 특정한 상황에서 설계를 돕기 위해 모방하고 수정할 수 있는 과거의 설계 경험이다.

즉, 공통으로 사용할 수 있는 역할, 책임, 협력의 템플릿이다.

일반적으로 반복적으로 발생하는 문제와 그 문제에 대한 해법의 쌍으로 정의된다. 해결하겨고 하는 문제가 무엇인지를 명확하게 서술하고 패턴을 적용할 수 있는 상황과 적용할 수 없는 상황을 함께 설명한다.
반복해서 일어나는 특정한 상황에서 어떤 설계가 왜 효과적인지에 대한 이유를 설명한다.

### 테스트-주도 개발

실패하는 테스트를 작성하고 테스트를 통과하는 가장 간단한 코드를 작성한 후 리팩터링을 통해 중복을 제거하는 것이다.

테스트-주도 개발은 책임-주도 설계를 통해 도달해야 하는 목적지를 테스트라는 안전장치를 통해 좀 더 빠르고 견고한 방법으로 도달할 수 있도록 해주는 설계 프렉티스다.

