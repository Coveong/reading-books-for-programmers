# 04. 역할, 책임, 협력

# 협력

## 요청하고 응답하며 협력하는 사람들

1. 다른 사람이 **요청**하여 **협력**이 시작된다.
2. 요청 받은 사람은 일을 처리하여 **응답**한다.

협력은 다수의 요청과 응답으로 이루어지며, 다수의 연쇄적인 요청, 응답의 흐름으로 구성된다.

## 책임의 분류

- 무엇을 알고 있는가 (knowing)
- 무엇을 할 수 있는가 (doing)

책임은 객체의 **공용 인터페이스**를 구성한다. → 후에 **캡슐화**로 이어짐

## 책임과 메시지

- 메시지 전송
    - 객체가 다른 객체에게 주어진 책임을 수행하도록 요청을 보내는 것
- 송신자
    - 요청하는 객체
- 수신자
    - 요청을 받는 객체

책임과 메시지의 수준이 같지 않다.

책임은 수행해야하는 행위를 상위 수준에서 개략적으로 서술한 것이다.

설계를 시작할 때에는 협력에 참여하기 위해 어떤 객체가 책임을 수행해야 하고, 어떤 객체로부터 메시지를 수신할 것인지 결정하는 것으로부터 시작된다. 클래스나 메서드는 그 다음에 정한다.

# 역할

## 책임의 집합이 의미하는 것

120p

## 역할이 답이다

협력 내에서 다른 객체(메시지를 동일한 방식으로 이해하는)로 대체할 수 있다.

- 판사
    - 왕
    - 왕비
- 토끼
- 증인
    - 모자장수
    - 앨리스
    - 요리사

객체지향 설계의 단순성, 유연성, 재사용성을 뒷받침하는 핵심 개념이다.

## 협력의 추상화

협력을 추상화함으로써 단순화할 수 있다.

## 대체 가능성

역할은 다른 객체에 의해 대체 가능하다.

또한 객체는 역할이 암시하는 책임보다 더 많은 책임을 가질 수 있다.

(ex. 모자 장수는 증인으로서의 역할 뿐만 아니라 모자를 판매하는 책임도 가진다.)

즉, 객체의 타입 - 역할에는 **일반화/특수화** 관계가 성립된다.

# 객체의 모양을 결정하는 협력

## 흔한 오류

1. 시스템에 필요한 데이터를 저장하기 위해 객체가 존재한다.

데이터는 객체가 행위를 수행하는 데 필요한 재료이다. **객체는 행위를 수행하며 협력에 참여하기 위해 존재한다.**

2. 객체지향이 클래스와 클래스 간의 관계를 표현하는 정적인 측면에 중점을 둔다.

정적인 클래스 < 동적인 객체가 중요도가 더 높다.

**클래스는 객체를 표현하고 생성하기 위한 구현 매커니즘이다.**

객체가 협력 안에서 어떤 책임과 역할을 수행할지가 중요하다.

보편적인 객체의 모습이 아닌, 책임에 따라 객체를 바라보자

## 협력을 따라 흐르는 객체의 책임

1. 객체에게 책임을 할당한다.
2. 책임에 필요한 행동을 정한다.
3. 행동에 필요한 데이터를 고민한다.

# 객체지향 설계 기법

## 책임-주도 설계

객체의 책임을 중심으로 시스템을 구축하는 설계 방법

1. 시스템 책임을 파악한다.
2. 시스템 책임을 더 작은 책임으로 분할한다.
3. 책임을 수행할 수 있는 적절한 객체, 역할을 찾아 할당한다.
4. 도와줄 다른 객체를 찾는다.
5. 두 객체가 협력하게 한다.

역할, 책임, 협력에 집중하자!

## 디자인 패턴

공통으로 사용할 수 있는 역할, 책임, 협력의 템플릿

책임-주도의 결과물인 동시에 지름길!

## 테스트-주도 개발

책임을 수행할 객체, 클라이언트가 기대하는 객체의 역할이 메시지를 수신할 때 어떤 결과를 반환하고 그 과정에서 어떤 객체와 협력할 것인지에 대한 기대를 코드의 형태로 작성하는 것