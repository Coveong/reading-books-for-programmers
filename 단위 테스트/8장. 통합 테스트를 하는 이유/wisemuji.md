# 통합 테스트를 하는 이유

- 통합 테스트의 역할 이해
- 테스트 피라미드의 개념 자세히 살펴보기
- 가치 있는 통합 테스트 작성

## 통합 테스트란?

- 단위 테스트가 아닌 모든 테스트
- 통합 테스트는 프로세스 외부 의존성과 도메인 모델을 연결함

![image](https://user-images.githubusercontent.com/32327475/196707548-14630b45-31f0-4321-80f8-14d8b5cd7d73.png)

### 통합 테스트의 장단점

- 장점: 테스트 코드를 많이 거치므로 회귀 방지가 단위 테스트보다 우수하다. 제품 코드와의 결합도가 낮아서 리팩터링 내성도 우수하다
- 단점: 프로세스 외부 의존성에 직접 작동하면 느려지고 유지비가 많이 든다.

단위 테스트로 가능한 많이 비즈니스 시나리오의 예외 상황을 확인하고, 통합 테스트는 주요 흐름과 단위 테스트가 다루지 못하는 기타 예외 상황을 다룬다.

## 빠른 실패 원칙

예기치 않은 오류가 발생하자마자 현재 연산을 중단하는 것.
- 피드백 루프 단축: 버그를 빨리 발견할수록 더 쉽게 해결 가능
- 지속성 상태 보호: 손상이 확산되는 것을 막을 수 있음

보통 예외를 던져서 현재 연산을 중지한다.

## 프로세스 외부 의존성의 분류

- 관리 의존성(전체를 제어할 수 있는 프로세스 외부 의존성): 애플리케이션을 통해서만 접근할 수 있으며 해당 의존성과의 상호작용은 외부 환경에서 볼 수 없다.
- 비관리 의존성(전체를 제어할 수 없는 프로세스 외부 의존성): 해당 의존성과의 상호작용을 외부에서 볼 수 있음

관리 의존성은 실제 인스턴스를 사용하고 비관리 의존성은 목으로 대체하라.

관리 의존성이면서 비관리 의존성의 경우 상호 작용을 검증하지 말고 최종 상태를 검증하라.

## 의존성 추상화를 위한 인터페이스 사용에 대한 고찰

- 구현이 하나뿐인 인터페이스 는 추상화가 아니며 해당 인터페이스를 구현하는 구체 클래스보다 결합도가 낮지 않다. 이러한 인터페이스에 대한 향후 구현을 예상하면 YAGNI 원칙을 위합ㄴ한다.
- 구현이 하나뿐인 인터페이스를 사용하기에 타당한 이유는 목을 사용하기 위한 것뿐이다. 비관리 의존성에만 사용하고, 관리 의존성은 구체 클래스를 사용하라.
