# 2. 단위 테스트란 무엇인가

# ‘단위 테스트'의 정의

- 작은 코드 조각을 검증하고,
- 빠르게 수행하고
- 격리된 방식으로 처리하는 자동화된 테스트
    - 런던파
        - 테스트 대상 시스템을 협력자에게서 격리하는 것
        - 하나의 클래스가 다른 클래스 또는 여러 클래스에 의존하면 이 모든 의존성을 테스트 대역(test double)으로 대체해야 한다.
        - 이점
            - 테스트가 실패하면 코드베이스의 어느 부분이 고장 났는지 확실히 알 수 있다.
            - 객체 그래프를 분할할 수 있다.
        - 고전파와의 차이점
            - 목을 사용하기 때문에 상호작용을 올바르게 했는지, 호출 횟수가 의도한대로 호출됐는지 확인할 수 있다.
        - 테스트 대역(목)으로 테스트 대상 코드 조각을 분리해서 격리 요구 사항에 다가간다.
    - 고전파
        - 단위 테스트끼리 격리하는 것을 “격리"라고 본다.
    - 차이점
        
        
        |  | 격리 주체 | 단위의 크기 | 테스트 대역 사용 대상 |
        | --- | --- | --- | --- |
        | 런던파 | 단위 | 단일 클래스 | 불변 의존성 외 모든 의존성 |
        | 고전파 | 단위 테스트 | 단일 클래스 또는 클래스 세트 | 공유 의존성 |

## 고전파와 런던파의 비교

“단위 테스트의 정의에서 격리 문제를 어떻게 다루는지”가 가장 큰 차이점이다.

고전파가 더 적합하다. 목을 사용하는 런던파 테스트는 불안정한 경향이 있기 때문이다.

런던파의 장점

- 한 번에 한 클래스만 테스트한다.
    - 좋은 코드 입자성을 목표로 하는 것은 도움이 되지 않는다. 테스트가 단일 동작 단위를 검증하는 한 좋은 테스트다.
    - 테스트는 해결하는 데 도움이 되는 문제에 대한 이야기를 들려줘야 하며, 이 이야기는 일반 사람들에게도 응집도가 높고 의미가 있어야 한다.
- 상호 연결된 클래스의 큰 그래프를 단위 테스트하기
    - 상호 연결된 클래스의 크고 복잡한 그래프를 테스트할 방법을 찾는 대신, 먼저 이러한 클래스 그래프를 갖지 않는 데 집중해야 한다.
- 버그 위치 정확히 찾아내기
    - 테스트를 정기적으로 실행하면 버그의 원인을 알아낼 수 있다.
    - 또한 버그가 많은 테스트에서 결함으로 이어진다면, 방금 고장 낸 코드 조각이 큰 가치가 있다는 것을 보여준다.
    

## 두 분파의 통합 테스트

- 런던파
    - 실제 협력자 객체를 사용하는 모든 테스트를 통합 테스트로 간주한다.
- 공유 의존성, 프로세스 외부 의존성 뿐만 아니라 조직 내 다른 팀이 개발한 코드 등과 통합해 작동하는지도 검증하는 테스트이다.