# 1. 단위 테스트의 목표

## 1.2 단위 테스트의 목표

소프트웨어 프로젝트의 **지속 가능한** 성장을 가능하게 하는 것.

테스트는 안전망 역할을 하며, 대부분의 회귀에 대한 보험을 제공하는 도구이다.

초반에 테스트 코드를 작성하기 위해 노력이 필요하지만, 후반에도 잘 성장할 수 있도록 하므로 장기적으로 보면 그 비용을 메울 수 있다.

### 1.2.1 좋은 테스트와 좋지 않은 테스트를 가르는 요인

테스트가 잘못 작성된 프로젝트는 초반에 테스트가 잘 작성된 프로젝트처럼 유지비용 비용이 적게 들지만, 시간이 지날수록 침체 단계에 빠진다.

- 기반 코드를 리팩터링할 때 테스트도 리팩터링하라.
- 각 코드 변경 시 테스트를 실행하라.
- 테스트가 잘못된 경고를 발생시킬 경우 처리하라.
- 기반 코드가 어떻게 동작하는지 이해하려고 할 때는 테스트를 읽는 데 시간을 투자하라.

높은 유지 보수 비용으로 인해 순가치가 0에 가깝거나 심지어 0보다 작은 테스트를 만들기 쉬ㅣㅂ다.

## 1.3 테스트 스위트 품질 측정을 위한 커버리지 지표

커버리지가 너무 적으면 → 테스트가 충분하지 않다는 좋은 증거

커버리지가 100%라면 → 반드시 양질의 테스트 스위트라고 보장할 수 없다. 높은 커버리지의 테스트 스위트라도 품질이 떨어질 수 있다.

### 1.3.1 코드 커버리지 지표에 대한 이해

코드 커버리지 = 실행 코드 라인 수 / 전체 라인수

커버리지가 높다고 모든 테스트 케이스에 대해 커버하는 것이 아니다.

```java
public static bool isStringLong(String input) {
	return input.length() > 5;
}

@Test
public void Test() {
	bool result = isStringLong("abc");
	Assert.Equal(false, result); // 커버리지는 100%지만, 모든 테스트 케이스에 대해 검사하지 않고 있다.
}
```

### 1.3.2 분기 커버리지 지표에 대한 이해

분기 커버리지 = 통과 분기 / 전체 분기 수

1.3.1에서 다룬 예제를 분기 커버리지 지표로 다루면 1/2 = 0.5 = 50%이다. if문을 사용하든, 더 짧은 표기법을 사용하든 상관없다. 분기 커버리지는 분기 개수만 다룬다.

### 1.3.3 커버리지 지표에 관한 문제점

- 테스트 대상 시스템의 모든 가능한 결과를 검증한다고 보장할 수 없다.
- 외부 라이브러리의 코드 경로를 고려할 수 있는 커버리지 지표는 없다.

### 1.3.4 특정 커버리지 숫자를 목표로 하기

특정 커버리지 숫자를 목표로 삼기 시작하면 위험 영역으로 이어질 수 있다. 커버리지 지표를 보는 가장 좋은 방법은 지표 그 자체로 보는 것이다.

코드 커버리지를 측정하는 것은 품질 테스트 스위트로 가는 첫걸음일 뿐이다.

## 1.4 무엇이 성공적인 테스트 스위트를 만드는가?

성공적인 테스트 스위트는 다음과 같은 특성을 갖고 있다.

- 개발 주기에 통합돼 있다.
    - 코드가 변경될 때마다 아무리 작은 것이라도 실행해야 한다.
- 코드 베이스에서 가장 중요한 부분만을 대상으로 한다.
    - 비즈니스 로직 중심으로 테스트 코드 작성하기
- 최소한의 유지비로 최대의 가치를 ㄲ르어낸다.